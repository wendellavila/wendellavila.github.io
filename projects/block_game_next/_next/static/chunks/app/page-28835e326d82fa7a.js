(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{830:function(e,t,i){Promise.resolve().then(i.bind(i,7621)),Promise.resolve().then(i.bind(i,3529)),Promise.resolve().then(i.bind(i,2089)),Promise.resolve().then(i.bind(i,1600)),Promise.resolve().then(i.bind(i,8803)),Promise.resolve().then(i.bind(i,2824)),Promise.resolve().then(i.bind(i,1643))},7750:function(e,t,i){"use strict";i.d(t,{o8:function(){return s.default},UW:function(){return a},JL:function(){return c.default},JM:function(){return h.default},fC:function(){return d.default},zp:function(){return f.default},eX:function(){return u.default}}),i(7621);var s=i(3529),l=i(7437);function n(e){return(0,l.jsx)("div",{className:"flex flex-col items-center justify-center min-h-6 min-w-6\n    bg-neutral-800 text-white text-md border-solid border-neutral-700\n    border-t-0 border-l-0 border-b-[3px] border-r-[3px]",children:e.children})}function o(e){return(0,l.jsx)("div",{className:"flex flex-row gap-2 ".concat(e.className),children:e.children&&e.children.map(e=>(0,l.jsx)(n,{children:e},e))})}function r(e){return(0,l.jsxs)("article",{className:"flex flex-row items-center justify-between gap-12 mb-8",children:[(0,l.jsx)("div",{className:"flex flex-col",children:e.children}),(0,l.jsx)("span",{className:"text-lg",children:e.message})]})}function a(){return(0,l.jsxs)("section",{id:"how-to-play",className:"border-solid border border-neutral-500 pt-2 px-6",children:[(0,l.jsx)("h3",{className:"text-xl text-center mb-4",children:"How to Play"}),(0,l.jsxs)(r,{message:"Move Block",children:[(0,l.jsx)(o,{className:"mb-4",children:["A","S","D"]}),(0,l.jsx)(o,{children:["⇦","⇩","⇨"]})]}),(0,l.jsx)(r,{message:"Rotate Block Left",children:(0,l.jsx)(o,{children:["Q","LShift"]})}),(0,l.jsx)(r,{message:"Rotate Block Right",children:(0,l.jsx)(o,{children:["E","Space"]})}),(0,l.jsx)(r,{message:"Hold Block",children:(0,l.jsx)(o,{children:["H"]})})]})}var c=i(2089),h=i(1600),d=i(8803),u=i(1643),f=i(2824)},7621:function(e,t,i){"use strict";i.d(t,{default:function(){return k}});var s=i(7437),l=i(2265);let n={width:10,height:20};class o{getXY(e){return this.values[e.y][e.x]}getRow(e){return this.values[e]}get width(){return this.values[0]?this.values[0].length:0}get height(){return this.values.length}setValues(e,t,i){let s=Math.max(t.y,0),l=Math.min(t.y+e.height,this.height),n=Math.max(t.x,0),o=Math.min(t.x+e.width,this.width);for(let r=s;r<l;r++)for(let s=n;s<o;s++){let l=e.getXY({x:s-t.x,y:r-t.y});(!0!==i||" "!==l)&&(this.values[r][s]=l)}}constructor(e){if(e.values)this.values=e.values;else{var t;this.values=Array.from(Array(null!==(t=e.height)&&void 0!==t?t:n.height),t=>{var i;return Array.from(Array(null!==(i=e.width)&&void 0!==i?i:n.width),e=>" ")})}}}class r{resetPosition(e){this.position={x:Math.floor(e.width/2)-this.width+1,y:-this.height+1}}getXY(e){return this.grid.getXY({x:e.x,y:e.y})}get grid(){return"only"in this.orientationGrids?this.orientationGrids.only:(this.orientationGrids,this.orientationGrids[this.orientation])}get height(){return this.grid.height}get width(){return this.grid.width}get y(){return this.position.y}get x(){return this.position.x}canPlace(){let e=this.height-1,t=Math.floor(this.playfield.width/2)-this.width+1;for(let i=0;i<this.width;i++){let s=" "!==this.getXY({x:i,y:e}),l=" "!==this.playfield.getXY({x:t+i,y:0});if(s&&l)return!1}return!0}tryMove(e){let t;if("down"===e){if(!(this.y+this.height<this.playfield.height))return!1;t={y:this.position.y+1,x:this.position.x}}else if("left"===e){if(!(this.x-1>=0))return!1;t={y:this.position.y,x:this.position.x-1}}else{if(!(this.x+this.width<this.playfield.width))return!1;t={y:this.position.y,x:this.position.x+1}}let i=new o({values:structuredClone(this.playfield.values)});i.setValues(new o({width:this.width,height:this.height}),this.position);for(let e=0;e<this.height;e++)if(!(e+t.y<0))for(let s=0;s<this.width;s++){let l=i.getXY({x:s+t.x,y:e+t.y}),n=this.getXY({x:s,y:e});if(" "!==l&&" "!==n)return!1}return i.setValues(this.grid,t,!0),this.position={y:t.y,x:t.x},this.playfield.setValues(i,{y:0,x:0}),!0}tryRotate(e){if("only"in this.orientationGrids)return!1;{let t,i,s;"upward"in this.orientationGrids?"upward"===this.orientation?(i="sideways",t={y:this.position.y,x:this.position.x+1}):(i="upward",t={y:this.position.y+1,x:this.position.x-1}):"right"===e?"up"===this.orientation?(i="right",t={y:this.position.y,x:this.position.x+1}):"right"===this.orientation?(i="down",t={y:this.position.y+1,x:this.position.x-1}):(i="down"===this.orientation?"left":"up",t={y:this.position.y,x:this.position.x}):"up"===this.orientation?(i="left",t={y:this.position.y,x:this.position.x}):"left"===this.orientation?(i="down",t={y:this.position.y+1,x:this.position.x}):"down"===this.orientation?(i="right",t={y:this.position.y,x:this.position.x+1}):(i="up",t={y:this.position.y,x:this.position.x-1}),s=this.orientationGrids[i];let l=new o({values:structuredClone(this.playfield.values)});l.setValues(new o({width:this.width,height:this.height}),this.position);for(let e=0;e<s.height;e++)if(!(e+t.y<0))for(let i=0;i<s.width;i++){let n=l.getXY({x:i+t.x,y:e+t.y}),o=s.getXY({x:i,y:e});if(" "!==n&&" "!==o)return!1}return l.setValues(s,t,!0),this.orientation=i,this.position={y:t.y,x:t.x},this.playfield.setValues(l,{y:0,x:0}),!0}}constructor(e,t){this.playfield=t,1===e.length?(this.orientationGrids={only:new o({values:e[0]})},this.orientation="only"):2===e.length?(this.orientationGrids={upward:new o({values:e[0]}),sideways:new o({values:e[1]})},this.orientation="upward"):(this.orientationGrids={up:new o({values:e[0]}),right:new o({values:e[1]}),down:new o({values:e[2]}),left:new o({values:e[3]})},this.orientation="up"),this.position={x:Math.floor(t.width/2)-this.width+1,y:-this.height+1}}}class a extends r{constructor(e){super([[["#","#"],["#","#"]]],e)}}class c extends r{constructor(e){super([[["I","I","I","I"]],[["I"],["I"],["I"],["I"]]],e)}}class h extends r{constructor(e){super([[["Z","Z"," "],[" ","Z","Z"]],[[" ","Z"],["Z","Z"],["Z"," "]]],e)}}class d extends r{constructor(e){super([[[" ","S","S"],["S","S"," "]],[["S"," "],["S","S"],[" ","S"]]],e)}}class u extends r{constructor(e){super([[[" "," ","L"],["L","L","L"]],[["L","L"],[" ","L"],[" ","L"]],[["L","L","L"],["L"," "," "]],[["L"," "],["L"," "],["L","L"]]],e)}}class f extends r{constructor(e){super([[["l","l","l"],[" "," ","l"]],[[" ","l"],[" ","l"],["l","l"]],[["l"," "," "],["l","l","l"]],[["l","l"],["l"," "],["l"," "]]],e)}}class x extends r{constructor(e){super([[["T","T","T"],[" ","T"," "]],[[" ","T"],["T","T"],[" ","T"]],[[" ","T"," "],["T","T","T"]],[["T"," "],["T","T"],["T"," "]]],e)}}var p=i(9065);class y{get levelSpeedTimeout(){return Math.max(50,1e3-(this.level-50))}get level(){return Math.floor(this.rowsCleared/10)+1}clearRows(){let e=0;for(let t=this.playfield.height-1;t>=0;t--){let i=!1;do{let s=0;for(let e=0;e<this.playfield.width;e++)" "===this.playfield.getXY({y:t,x:e})&&s++;if(0===s){for(let e=t;e>=1;e--)this.playfield.setValues(new o({values:[this.playfield.getRow(e-1)]}),{y:e,x:0});this.playfield.setValues(new o({width:this.playfield.width,height:1}),{y:0,x:0}),e++,i=!0}else i=!1}while(i)}e>0&&(this.score+=40*e*this.level,this.rowsCleared+=e,this.updateScoreState(),this.updateLevelState())}placeBlock(e){this.playfield.setValues(e.grid,e.position)}getRandomBlock(){switch(Math.floor(7*Math.random()+0)){case 0:return new u(this.playfield);case 1:return new f(this.playfield);case 3:return new c(this.playfield);case 4:return new d(this.playfield);case 5:return new a(this.playfield);case 6:return new x(this.playfield);default:return new h(this.playfield)}}tryBlockAction(e,t,i){let s=!1;return"rotation"===t&&"down"!==i?s=e.tryRotate(i):"movement"===t&&(s=e.tryMove(i)),s&&this.updatePlayfieldState(),s}holdBlock(e){let t;return this.playfield.setValues(new o({width:e.width,height:e.height}),e.position),this.onHoldBlock&&(t=this.onHoldBlock).resetPosition(this.playfield),this.onHoldBlock=e,this.updateHoldBlockState(),t}getNextBlock(){let e=this.nextBlocks.shift();return this.nextBlocks.push(this.getRandomBlock()),this.placeBlock(e),this.updateNextBlocks(),e}updatePlayfieldState(){this.setPlayfieldCallback(structuredClone(this.playfield.values))}updateNextBlocks(){this.setNextBlocksCallback(this.nextBlocks.map(e=>structuredClone(e.grid.values)))}updateScoreState(){this.setScoreCallback(this.score)}updateLevelState(){this.setLevelCallback(this.level)}updateHoldBlockState(){this.setHoldBlockCallback(this.onHoldBlock?this.onHoldBlock.grid.values:void 0)}async play(){for(this.updatePlayfieldState(),await (0,p._v)(200);this.nextBlocks[0].canPlace();){let e=this.getNextBlock(),t=!1,i=!0,s=!1;for(;i&&!s;){if(this.updatePlayfieldState(),t)await (0,p._v)(12);else{let i=Date.now(),l=i;for(;l-i<this.levelSpeedTimeout;){try{let i=(await (0,p.xh)(this.levelSpeedTimeout)).key;if(["ArrowDown","s","S","Enter"].includes(i)){t=!0;break}if(["ArrowLeft","a","A"].includes(i))this.tryBlockAction(e,"movement","left");else if(["ArrowRight","d","D"].includes(i))this.tryBlockAction(e,"movement","right");else if(["q","Q","LeftShift"].includes(i))this.tryBlockAction(e,"rotation","left");else if(["e","E"," "].includes(i))this.tryBlockAction(e,"rotation","right");else if(["h","H"].includes(i)){let t=this.holdBlock(e);t?e=t:s=!0;break}}catch(e){}l=Date.now()}}s||(i=this.tryBlockAction(e,"movement","down"))}this.clearRows()}return this.score}constructor(e){this.playfield=new o({width:e.playfieldWidth,height:e.playfieldHeight}),this.score=0,this.rowsCleared=0,this.nextBlocks=[this.getRandomBlock(),this.getRandomBlock(),this.getRandomBlock()],this.setPlayfieldCallback=e.setPlayfieldCallback,this.setLevelCallback=e.setLevelCallback,this.setScoreCallback=e.setScoreCallback,this.setNextBlocksCallback=e.setNextBlocksCallback,this.setHoldBlockCallback=e.setHoldBlockCallback}}var w=i(7750);function m(e){return(0,s.jsxs)("section",{id:"game-over",className:"flex flex-col items-center justify-center grow",children:[(0,s.jsx)("span",{className:"text-3xl mb-1",children:"Game Over"}),(0,s.jsxs)("span",{className:"text-xl mb-6",children:["Score: ",e.score]}),(0,s.jsx)("span",{className:"text-md mb-4",children:"Play again?"}),(0,s.jsx)(w.JM,{onClick:e.onClick})]})}function g(e){return(0,s.jsxs)("section",{id:"game-start",className:"flex flex-col items-center",children:[(0,s.jsx)(w.JM,{onClick:e.onClick,className:"mb-8"}),(0,s.jsx)(w.UW,{})]})}function k(){let[e,t]=(0,l.useState)("not started"),[i,n]=(0,l.useState)(void 0),[o,r]=(0,l.useState)(0),[a,c]=(0,l.useState)(1),[h,d]=(0,l.useState)(void 0),[u,f]=(0,l.useState)([]),[x,p]=(0,l.useState)(new y({setPlayfieldCallback:n,setLevelCallback:c,setScoreCallback:r,setNextBlocksCallback:f,setHoldBlockCallback:d})),k=()=>{n(void 0),r(0),c(1),d(void 0),f([]),p(new y({setPlayfieldCallback:n,setLevelCallback:c,setScoreCallback:r,setNextBlocksCallback:f,setHoldBlockCallback:d}))},b=async e=>{!0===e&&k(),t("playing"),await x.play(),t("over")};return(0,s.jsxs)("main",{className:"flex flex-col p-8 items-center",children:["not started"===e&&(0,s.jsx)(g,{onClick:()=>b(!1)}),"over"===e&&(0,s.jsx)(m,{score:o,onClick:()=>b(!0)}),"playing"===e&&(0,s.jsxs)("section",{id:"game",className:"flex flex-row gap-4 grow",children:[(0,s.jsx)(w.o8,{block:h}),(0,s.jsx)(w.fC,{playfield:i}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)(w.JL,{blocks:u}),(0,s.jsx)(w.zp,{id:"level",title:"Level",value:a}),(0,s.jsx)(w.zp,{id:"score",title:"Score",value:o})]})]})]})}},3529:function(e,t,i){"use strict";i.d(t,{default:function(){return o}});var s=i(7437),l=i(9065),n=i(7750);function o(e){return(0,s.jsxs)("section",{className:"flex flex-col items-center animate-fade-down animate-ease-out animate-duration-700",children:[(0,s.jsx)(n.eX,{children:"Hold"}),(0,s.jsx)("div",{id:"hold-block-layout",className:"flex flex-col items-center justify-center p-2 mt-2\n        border-neutral-800 border-2 border-solid ".concat(e.block?"":"w-[70px] h-[70px]"),children:e.block&&e.block.map((e,t)=>(0,s.jsx)("div",{id:"hold-block-row-".concat(t+1),className:"flex flex-row",children:e.map((e,i)=>(0,s.jsx)("div",{id:"hold-block-row-".concat(t+1,"-cell-").concat(i+1),className:"h-4 w-4 border-[1px]\n                ".concat(" "!==e?"border-neutral-900":"border-transparent","\n                ").concat(" "!==e?(0,l.Cd)(e):"bg-transparent")},"hold-block-row-".concat(t+1,"-cell-").concat(i+1)))},"hold-block-row-".concat(t+1)))})]})}},2089:function(e,t,i){"use strict";i.d(t,{default:function(){return o}});var s=i(7437),l=i(9065),n=i(7750);function o(e){return(0,s.jsxs)("section",{id:"next-blocks",className:"flex flex-col items-center animate-fade-down animate-ease-out animate-duration-700",children:[(0,s.jsx)(n.eX,{children:"Next"}),e.blocks.map((e,t)=>(0,s.jsx)("div",{id:"next-block-".concat(t+1),className:"mt-4",children:e.map((e,i)=>(0,s.jsx)("div",{id:"next-block-".concat(t+1,"-row-").concat(i+1),className:"flex flex-row",children:e.map((e,n)=>(0,s.jsx)("div",{id:"next-block-".concat(t+1,"-row-").concat(i+1,"-cell-").concat(n+1),className:"h-4 w-4 border-[1px]\n                    ".concat(" "!==e?"border-neutral-900":"border-transparent","\n                    ").concat(" "!==e?(0,l.Cd)(e):"bg-transparent")},"next-block-".concat(t+1,"-row-").concat(i+1,"-cell-").concat(n+1)))},"next-block-".concat(t+1,"-row-").concat(i+1)))},t))]})}},1600:function(e,t,i){"use strict";i.d(t,{default:function(){return l}});var s=i(7437);function l(e){return(0,s.jsx)("button",{className:"\n      px-4 py-1 bg-transparent border-2 border-solid animate-pulse\n      border-red-500 text-white ".concat(e.className),"aria-label":"Play Game",onClick:e.onClick,children:"▶ Play"})}},8803:function(e,t,i){"use strict";i.d(t,{default:function(){return n}});var s=i(7437),l=i(9065);function n(e){return e.playfield&&(0,s.jsx)("section",{id:"playfield",className:"animate-fade-down animate-ease-out animate-duration-500",children:e.playfield.map((e,t)=>(0,s.jsx)("div",{id:"playfield-row-".concat(t+1),className:"flex flex-row",children:e.map((e,i)=>(0,s.jsx)("div",{id:"playfield-row-".concat(t+1,"-cell-").concat(i+1),className:"h-6 w-6 border-[1px] border-neutral-900\n              ".concat((0,l.Cd)(e))},"playfield-row-".concat(t+1,"-cell-").concat(i+1)))},"playfield-row-".concat(t+1)))})}},2824:function(e,t,i){"use strict";i.d(t,{default:function(){return n}});var s=i(7437),l=i(7750);function n(e){return(0,s.jsxs)("section",{id:e.id,className:"flex flex-col items-center animate-fade-down animate-ease-out animate-duration-700",children:[(0,s.jsx)(l.eX,{children:e.title}),(0,s.jsx)("span",{className:"text-lg leading-tight mt-1",children:e.value})]})}},1643:function(e,t,i){"use strict";i.d(t,{default:function(){return l}});var s=i(7437);function l(e){return(0,s.jsx)("span",{className:"px-2 py-0 bg-neutral-800 text-white",children:e.children})}},9065:function(e,t,i){"use strict";function s(e){switch(e){case"#":return"bg-yellow-500";case"Z":return"bg-red-500";case"S":return"bg-green-500";case"I":return"bg-cyan-500";case"L":return"bg-orange-500";case"l":return"bg-blue-500";case"T":return"bg-purple-500";default:return"bg-neutral-800"}}async function l(e){return new Promise(t=>setTimeout(t,e))}async function n(e){return new Promise((t,i)=>{let s;e&&(s=setTimeout(()=>i("No keys pressed in ".concat(e," ms.")),e)),new Promise(e=>window.addEventListener("keydown",e,{once:!0})).then(e=>{s&&clearTimeout(s),t(e)})})}i.d(t,{Cd:function(){return s},_v:function(){return l},xh:function(){return n}})}},function(e){e.O(0,[971,23,744],function(){return e(e.s=830)}),_N_E=e.O()}]);